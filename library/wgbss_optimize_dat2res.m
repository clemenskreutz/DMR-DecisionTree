function [res,sres] = wgbss_optimize_dat2res(dat,p)

    res = [dat.Meth.mean, dat.NonMeth.mean, dat.Meth.sd, dat.NonMeth.sd, ...
    dat.Meth.meanNread, dat.Meth.sdNread, ...  
    dat.NonMeth.meanNread, dat.NonMeth.sdNread, ...
    dat.meanLog10DiffPos, dat.sdLog10DiffPos, ...
    dat.meanLog10MethLengthPos, dat.sdLog10MethLengthPos, ...
    dat.meanLog10NonMethLengthPos, dat.sdLog10NonMethLengthPos, ...
    mean(dat.smooth.threshFreqC,1),...
    mean(dat.smooth.threshNread,1)];

% save res res

res = double(res);

if nargin>1
    sres = zeros(length(res),length(p));
else
    sres = [];
end


